class Vulnerability < ApplicationRecord
  belongs_to :affected_host
  has_one :remedy_action, dependent: :destroy

  validates :vulnerability_name, presence: true
  validates :cvss_score, inclusion: { in: 1..10 }
  validates :port, inclusion: { in: 0..65535 }

  validates_uniqueness_of :vulnerability_name, scope: [:affected_host_id, :port, :output]

  after_save :create_remedy_action_ref

  def create_remedy_action_ref
    self.create_remedy_action!
  end
end
